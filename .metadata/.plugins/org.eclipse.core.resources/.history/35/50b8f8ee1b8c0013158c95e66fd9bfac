package com.tvergilio.googleit;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;

public class PushReceiver extends BroadcastReceiver {

	@Override
	public void onReceive(Context context, Intent intent) {
		AlarmReceiver.acquireLock(context);
		if (intent.getAction().equals(
				"com.google.android.c2dm.intent.REGISTRATION")) {
			onRegistration(context, intent);
		} else if (intent.getAction().equals(
				"com.google.android.c2dm.intent.RECEIVE")) {
			onMessage(context, intent);
		}
	}

	private void onMessage(Context context, Intent intent) {
		Intent suggestService = new Intent(context,
				GoogleSuggestManagerService.class);
		suggestService.putExtras(intent);
		context.startService(suggestService);
	}

	private void onRegistration(Context context, Intent intent) {
		String regId = intent.getStringExtra("registration_id");
		if (regId != null) {
			Intent i = new Intent(context, SendC2dmRegistrationService.class);
			i.putExtra("regId", regId);
			context.startService(i);
		}

	}

}
